Structure selection for DFT calculations
====================================================================================================

Theoretical backgrounds
------------------------

See [CE1]_ to find how to select DFT structures.

search_poscar_variance
------------------------

* Searching for a DFT structure for validating and improving a trial CE using the simulated annealing.
* DFT structures used for constructing the trial CE is specified by CORRELATION file.
* Available only for binary system.

**Input files**

* MKPOS.in
* :ref:`label-e-uposcar`
* :ref:`label-e-upotcar`
* :ref:`label-e-correlation`
* :ref:`label-e-of-out`
* :ref:`label-e-variance`
* :ref:`label-e-mean`

**Output files**

* POSCAR_new

MKPOS.in
----------

Searching for a structure with the lattice constructed by the 2x2x1 expansion of a 4-atoms unit cell (16-atoms cell).
The structure has 12 A-atoms (spin=+1) and 4 B-atoms (spin=-1). 
The structure is optimized for clusters specified by CLUSTERINDEX. ::

    ISUB = 1
    NUCELL = 2 2 1
    NCHANGE = 4
    SPIN = 1 -1
    NALLCLUSTER = 53
    CLUSTERINDEX = 0 1 2 3 4 5 8 16 35 49 48
    TEMPINIT = 1000
    TEMPFINAL = 1
    TEMPMUL = 0.99
    NSTEP = 20

ISUB tag
""""""""""""""""
Sublattice indexes for considering atomic configurations.
Atomic configurations are considered on ISUBth lattice sites of UPOSCAR (line 6).

* Default : 1
* Example : ISUB = 1 3

NCHANGE tag
""""""""""""""""""""""
Number of atoms.
In N-nary systems, set N-1 kinds of atoms.
The number of the other kind of atoms is automatically set to (number of lattice sites - NCHANGE).

* Default : none
* Example : NCHANGE = 16

SPIN tag
""""""""""""""""""""""
Spin values of atoms.
In binary systems, SPIN tag has two kinds of values.
The same correspondence between spins and atom types used in **correlation** should be used here.

* Default : none
* Example : SPIN = 1 -1

In the above example, spin values of NCHANGE atoms are set to -1.

NUCELL tag
""""""""""""""""""""""
A structure is searched for using the NUCELL expansion of the unit cell.

* Default : none
* Example : NUCELL = 2 2 2

NALLCLUSTER tag
""""""""""""""""""""""
Number of all clusters included in CORRELATION file.

* Default : none
* Example : NALLCLUSTER = 53

CLUSTERINDEX tag
""""""""""""""""""""""
Indexes of clusters used for the trial CE.

* Default : none
* Example : CLUSTERINDEX = 0 1 2 3 4 5 8 16 35 48 49

TEMPINIT tag, TEMPFINAL tag
"""""""""""""""""""""""""""""
Initial and final temperatures in the simulated annealing.

* Default : none
* Example : TEMPINIT = 1
* Example : TEMPFINAL = 0.001

TEMPMUL tag
""""""""""""""""""""""
Exponential base for an automatic setting of temperatures in the simulated annealing.
Set values ranged from 0 to 1.

* Default : none
* Example : TEMPMUL = 0.9

NSTEP tag
""""""""""""""""""""""
Number of steps for simulated annealing at one temperature.

* Default : none
* Example : NSTEP = 20

variance_energy
------------------------

* Calculating the mean variance of the predicted energy.

**Input files**

* LS.in
* :ref:`label-e-correlation`
* :ref:`label-e-variance`
* :ref:`label-e-mean`

**Output files**

* Mean variance of the predicted energy


variance_stpop
------------------------

* Under development.

* Generating VARIANCE and MEAN files required in **search_poscar_variance**.
* VARIANCE and MEAN files can be generated by calculating correlation functions using **correlation** for random structures generated by **mkposcar** and calculating their means and variances.

**Input files**

* VAR.in
* :ref:`label-e-uposcar`
* :ref:`label-e-upotcar`
* :ref:`label-e-of-out`

**Output files**

* VARIANCE
* MEAN

